<html>
	<head>
		<title>MyStock</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
		<script src="https://code.highcharts.com/adapters/standalone-framework.src.js"></script>
		<script src="https://code.highcharts.com/highcharts.src.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/spin.js/2.3.2/spin.js"></script>
		<script type="text/javascript" src="index.js"></script>
	</head>

	<body onload="initialize()">

		<div id="spinner"></div>
		<div class="container">
		  <h3>My Stock</h3>
		  <div class="col-lg-6">
			  <div class="input-group">
			    <input type="text" class="form-control" placeholder="Add Symbol" id="newSymbol">
			    <span class="input-group-btn">
			      <button class="btn btn-default" type="button" onclick="addSymbol()">Add</button>
			    </span>
			  </div>
		  </div>
		  <ul class="nav nav-tabs" style="float:left; padding-top:1rem">
		    <li class="active" id="tab7"><a onclick="showStockChart(7)">One Week</a></li>
		    <li id="tab30"><a onclick="showStockChart(30)">One Month</a></li>
		    <li id="tab90"><a onclick="showStockChart(90)">Three Months</a></li>
		    <li id="tab180"><a onclick="showStockChart(180)">Half Year</a></li>
		    <li id="tab365"><a onclick="showStockChart(365)">One Year</a></li>
		    <li id="tab730"><a onclick="showStockChart(730)">Two Years</a></li>
		  </ul>
		</div>


		<div id="charts" style="display:flex; flex-wrap:wrap;"></div>

		<script type="text/javascript">
			// $('#spinner').hide();

			// var spinner = new Spinner({
			// 	lines: 12, // The number of lines to draw
			// 	length: 7, // The length of each line
			// 	width: 5, // The line thickness
			// 	radius: 10, // The radius of the inner circle
			// 	color: '#337ab7', // #rbg or #rrggbb
			// 	speed: 1, // Rounds per second
			// 	trail: 100, // Afterglow percentage
			// 	shadow: true, // Whether to render a shadow
			// 	zIndex: 100
			// }).spin(document.getElementById("spinner"));



			// // Default show 1 week
			// var currentActiveTab = 'tab7';
			// showStockChart(7);

			// function showStockChart(numOfDays) {
			// 	// Clear the existing chart first
			// 	$('#charts').empty();

			// 	$.ajax({
			// 		url: '/yahooFinance/' + numOfDays,
			// 		success: function(data, statusCode, jqXHR) {
			// 			console.log(data);
			// 			var polishedData = polishData(data);
			// 			prepareChartPlaceholder(polishedData.length);
			// 			drawChart(polishedData);
			// 		},
			// 		error: function(jqXHR, statusCode, e) {
			// 			console.log(e);
			// 		}
			// 	});

			// 	$('#' + currentActiveTab).removeClass('active');
			// 	currentActiveTab = 'tab' + numOfDays;
			// 	$('#' + currentActiveTab).addClass('active');
			// }

			
			//  rawData format
			//  [  
			//    [  
			//       {  
			//          "date":"2015-05-01T07:00:00.000Z",
			//          "open":79.24,
			//          "high":79.76,
			//          "low":78.11,
			//          "close":78.99,
			//          "volume":22783300,
			//          "adjClose":78.99,
			//          "symbol":"FB"
			//       },
			//       {  
			//          "date":"2015-05-02T07:00:00.000Z",
			//          "open":79.24,
			//          "high":79.76,
			//          "low":78.11,
			//          "close":78.99,
			//          "volume":22783300,
			//          "adjClose":78.99,
			//          "symbol":"FB"
			//       }
			//    ],
			//    [  
			//       {  
			//          "date":"2015-05-01T07:00:00.000Z",
			//          "open":73.37,
			//          "high":74.5,
			//          "low":72,
			//          "close":73.36,
			//          "volume":9189500,
			//          "adjClose":73.36,
			//          "symbol":"CRM"
			//       },
			//       {  
			//          "date":"2015-05-02T07:00:00.000Z",
			//          "open":73.37,
			//          "high":74.5,
			//          "low":72,
			//          "close":73.36,
			//          "volume":9189500,
			//          "adjClose":73.36,
			//          "symbol":"CRM"
			//       }
			//    ]
			// ]

			//  And polish data format
			//  [  
			//    {
			// 	 'symbol' : 'CRM',
			// 	 'price' : '75, 74, 76',
			// 	 'data' : '2015-05-01, 2015-05-02'
			//    }, 
			//    {
			// 	 'symbol' : 'FB',
			// 	 'price' : '73, 74, 76',
			// 	 'data' : '2015-05-01, 2015-05-02'
			//    }
			//  ]
			 
			// function polishData(rawData) {
			// 	polishedData = [];
			// 	rawData.forEach(function(stockDetail) {
			// 		if (stockDetail.length > 0) {
			// 			var singlePolishData = {
			// 				symbol : stockDetail[0]['symbol'],
			// 				price : [],
			// 				date : []
			// 			}
			// 			stockDetail.forEach(function(singleDayDetail) {
			// 				singlePolishData['price'].push(singleDayDetail['close']);
			// 				singlePolishData['date'].push(singleDayDetail['date'].slice(0,10));
			// 			})

			// 			polishedData.push(singlePolishData);
			// 		}
			// 	});

			// 	return polishedData;
			// }

			// function drawChart(data) {
			// 	data.forEach(function(symbolDetail, index) {
			// 		new Highcharts.Chart({
			//             chart: {
			//                 renderTo: "chart"+index
			//             },
			//             legend: {
			//                 enabled: false
			//             },
			//             plotOptions: {
			//                 series: {
			//                     marker: {
			//                         enabled: true
			//                     },
			//                     shadow: true
			//                 }
			//             },
			//             xAxis: {
			// 	            categories: symbolDetail['date']
			// 	        },
			// 	        yAxis: {
			// 	        	title: {text: 'Price'}
			// 	        },
			//             series: [{
			//                 data: symbolDetail['price']
			//             }],
			//             title: {
			//                 text: symbolDetail['symbol']
			//             },
			//             tooltip: {
			//                 enabled: true
			//             }
			//         });
			// 	});
			// }

			// function prepareChartPlaceholder(numberOfChart) {
			// 	var charts = document.getElementById('charts');
			// 	for (var i = 0; i < numberOfChart; i++) {
			// 		var div = document.createElement('div');
			// 		div.setAttribute('id', 'chart'+i);
			// 		div.setAttribute('style', 'width:50%;');
			// 		charts.appendChild(div);
			// 	}
			// }


			// // CRUD stuff

			// function addSymbol () {
			// 	$('#spinner').show();
			// 	$.ajax({
			// 		url: '/addSymbol?symbol=' + $('#newSymbol').val(),
			// 		success: function(data, statusCode, jqXHR) {
			// 			console.log('Success to post data');
			// 			$('#newSymbol').val('');
			// 			// Hack here, wait for 2.5 seconds and refresh the page
			// 			setTimeout(function() {
			// 				$('#spinner').hide();
			// 				location.reload();
			// 			}, 2500);
			// 		},
			// 		error: function(jqXHR, statusCode, e) {
			// 			console.log(e);
			// 			$('#newSymbol').val('');
			// 		}
			// 	});
			// }
		</script>
	</body>

</html>